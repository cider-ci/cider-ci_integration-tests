scripts: 
  run-ready:
    body: |
      #!/usr/bin/env bash
      set -euo pipefail
      # add some random sleep since likely on the
      # first run this will cause a dispatch storm like thing
      sleep $((RANDOM % 5))
      exit 0
    start_when:
      db is migrated: {script_key: 'migrate-database'}
      ruby is bundled: {script_key: 'bundle-rspec-ruby'}
      ui is bundled: {script_key: 'ui-bundle'}
  run-server:
    start_when: {ready: {script_key: 'run-ready'}}
  run_github-api-mock:
    start_when: {ready: {script_key: 'run-ready'}}
  run-reverse-proxy:
    start_when: {ready: {script_key: 'run-ready'}}
  ui-run:
    start_when: {ready: {script_key: 'run-ready'}}
  run-executor: 
    start_when: {ready: {script_key: 'run-ready'}}

